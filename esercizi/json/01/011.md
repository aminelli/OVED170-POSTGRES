```sql
-- ===============================================
-- QUERY COMPLESSE DI ESEMPIO
-- ===============================================

-- Query complessa: trovare utenti con notifiche email abilitate
-- che vivono in cittÃ  specifiche
SELECT 
    name,
    email,
    profile->>'city' as city,
    preferences->'notifications'->>'email' as email_notifications
FROM users 
WHERE preferences->'notifications'->>'email' = 'true'
    AND profile->>'city' IN ('Milano', 'Roma');

-- Analisi prodotti: contare caratteristiche per categoria
SELECT 
    metadata->>'category' as category,
    jsonb_object_keys(specifications) as feature,
    COUNT(*) as feature_count
FROM products, jsonb_object_keys(specifications)
GROUP BY metadata->>'category', jsonb_object_keys(specifications)
ORDER BY category, feature_count DESC;

-- Ricerca full-text in JSON
SELECT name, specifications
FROM products 
WHERE to_tsvector('english', specifications::text) @@ to_tsquery('OLED | SSD');
```