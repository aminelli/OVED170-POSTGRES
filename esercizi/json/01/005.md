```sql
-- ===============================================
-- 6. FUNZIONI JSON AVANZATE
-- ===============================================

-- json_each/jsonb_each: espandere oggetti JSON
SELECT name, key, value 
FROM users, jsonb_each(preferences->'notifications');

-- json_array_elements: espandere array JSON
SELECT name, jsonb_array_elements_text(profile->'skills') as skill
FROM users 
WHERE profile->'skills' IS NOT NULL;

-- json_object_keys: ottenere le chiavi
SELECT DISTINCT jsonb_object_keys(specifications) as spec_keys 
FROM products;

-- jsonb_pretty: formattare JSON
SELECT name, jsonb_pretty(specifications) 
FROM products 
WHERE name = 'Smartphone X1';

```