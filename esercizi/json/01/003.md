```sql

-- ===============================================
-- 3. QUERY DI BASE - ACCESSO AI DATI JSON
-- ===============================================

-- Operatore -> restituisce JSON
SELECT name, profile->'age' as age FROM users;

-- Operatore ->> restituisce testo
SELECT name, profile->>'city' as city FROM users;

-- Accesso a oggetti annidati
SELECT name, preferences->'notifications'->>'email' as email_notifications 
FROM users;

-- Accesso ad array
SELECT name, profile->'skills'->0 as first_skill 
FROM users 
WHERE profile->'skills' IS NOT NULL;

-- ===============================================
-- 4. QUERY CON FILTRI JSON
-- ===============================================

-- Filtrare per valori JSON
SELECT * FROM users WHERE profile->>'city' = 'Milano';

-- Filtrare per valori numerici
SELECT * FROM users WHERE (profile->>'age')::int > 25;

-- Controllare esistenza di chiavi
SELECT * FROM users WHERE preferences ? 'notifications';

-- Controllare esistenza di chiavi multiple
SELECT * FROM users WHERE preferences ?& array['notifications', 'language'];

-- Controllare esistenza di almeno una chiave
SELECT * FROM users WHERE preferences ?| array['notifications', 'language'];

```